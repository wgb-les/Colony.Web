(function(n){n.fn.fcbkcomplete=function(t){return this.queue(function(){function at(){vt(),ot(0)}function vt(){if(s=n('<ul class="holder"><\/ul>').width(r.width),r.attachto?typeof r.attachto=="object"?r.attachto.append(s):n(r.attachto).append(s):u.after(s),h=n('<div class="facebook-auto">').width(r.width),r.complete_text!=""){var t=r.complete_text;h.append('<div class="default">'+t+"<\/div>"),r.select_all_text&&h.children(".default").append(n('<a href="" class="select_all_items">'+r.select_all_text+"<\/a>").click(function(){return n(u).trigger("selectAll"),!1}))}h.hover(function(){ut=0},function(){ut=1}),f=n('<ul id="'+p+'_feed"><\/ul>').width(r.width),s.after(h.prepend(f)),yt()}function yt(){name=u.attr("name"),r.bricket&&typeof name!="undefined"&&name.indexOf("[]")==-1&&(name=name+"[]");var t=n("<"+u.get(0).tagName+' name="'+name+'" id="'+p+'" multiple="multiple" class="'+u.get(0).className+' hidden">').data("cache",{});n.each(u.children("option"),function(i,r){if(r=n(r),t.data("cache")[r.val()]=r.text(),r.hasClass("selected")){var u=c(r.text(),r.val(),!0,r.hasClass("locked"));t.append('<option value="'+r.val()+'" selected="selected" id="opt_'+u+'"class="selected">'+r.text()+"<\/option>")}}),u.after(t),u.remove(),u=t,n(u).bind("addItem",function(n,t){c(t.title,t.value,0,0,0)}),n(u).bind("removeItem",function(n,t){var i=s.children("li[rel="+t.value+"]");i.length&&k(i)}),n(u).bind("destroy",function(){s.remove(),h.remove(),u.show()}),n(u).bind("selectAll",function(){var t=n(u).val()||[];n.each(n(u).data("cache"),function(i,r){n.inArray(i,t)===-1&&c(r,i,0,0,0)}),f.parent().hide()})}function c(t,i,f,e,o){var c;if(!v())return!1;var y="bit-box"+(e?" locked":""),h=kt(),b=document.createTextNode(l(t)),a=n('<a class="closebutton" href="#"><\/a>'),d=n('<li class="'+y+'" rel="'+i+'" id="pt_'+h+'"><\/li>').prepend(b).append(a);return s.append(d),a.click(function(){return k(n(this).parent("li")),!1}),f||(n("#"+p+"_annoninput").remove(),ot(o),c=n('<option value="'+l(i,1)+'" id="opt_'+h+'" class="selected" selected="selected">'+l(t)+"<\/option>"),u.append(c),r.onselect&&tt(r.onselect,c),u.change()),s.children("li.bit-box.deleted").removeClass("deleted"),w(1),h}function k(t){var i,f;t.hasClass("locked")||(t.fadeOut("fast"),i=t.attr("id"),r.onremove&&(f=i?n("#o"+i+""):u.children("option[value="+t.attr("rel")+"]"),tt(r.onremove,f)),i?n("#o"+i+"").remove():u.children('option[value="'+t.attr("rel")+'"]').remove(),t.remove(),u.change(),rt=0)}function ot(t){var u=n('<li class="bit-input" id="'+p+'_annoninput">'),i=n('<input type="text" class="maininput" size="'+r.input_min_size+'" autocomplete="off">');r.input_tabindex>0&&i.attr("tabindex",r.input_tabindex),r.input_name!=""&&i.attr("name",r.input_name),s.append(u.append(i)),i.focus(function(){it=!0,v()&&h.fadeIn("fast")}),i.blur(function(){it=!1,ut?h.fadeOut("fast"):i.focus()}),s.click(function(){r.input_min_size<0&&f.length&&lt(y(i.val(),1)),i.focus(),f.length&&i.val().length>r.input_min_size?f.show():(w(1),h.children(".default").show())}),i.keypress(function(n){if(n.keyCode==o.enter)return!1;var t=r.input_min_size>i.val().length?r.input_min_size:i.val().length+1;i.attr("size",t).width(parseInt(i.css("font-size"))*t)}),i.keyup(function(t){var u=y(i.val(),1);if(t.keyCode==o.backspace&&u.length==0&&(w(1),!s.children("li.bit-box:last").hasClass("locked"))){if(s.children("li.bit-box.deleted").length==0)return s.children("li.bit-box:last").addClass("deleted"),!1;if(rt)return;rt=1,s.children("li.bit-box.deleted").fadeOut("fast",function(){return k(n(this)),!1})}t.keyCode!=o.downarrow&&t.keyCode!=o.uparrow&&t.keyCode!=o.leftarrow&&t.keyCode!=o.rightarrow&&u.length>r.input_min_size&&(lt(u),h.children(".default").hide(),f.show())}),r.oncreate&&tt(r.oncreate,i),t&&setTimeout(function(){i.focus(),h.children(".default").show()},1)}function d(t,i){f.html(""),r.cache||i==null||a.clear(),bt(t),i!=null&&i.length&&n.each(i,function(n,t){a.set(y(t.key),y(t.value))});var o=r.maxshownitems<a.length()?r.maxshownitems:a.length(),s="";n.each(a.search(t),function(n,i){o&&(r.filter_selected&&u.children('option[value="'+i.key+'"]').hasClass("selected")||(s+='<li rel="'+i.key+'">'+l(pt(i.value,t))+"<\/li>",b++,o--))}),f.append(s),r.firstselected&&(e=f.children("li:visible:first"),e.addClass("auto-focus")),b>r.height?f.css({height:r.height*24+"px",overflow:"auto"}):f.css("height","auto"),v()&&h.is(":hidden")&&h.show()}function pt(n,t){var u=r.filter_begin?"":"(.*)",f=r.filter_begin?"<em>$1<\/em>$2":"$1<em>$2<\/em>$3",e=u+(r.filter_case?"("+t+")(.*)":"("+t.toLowerCase()+")(.*)"),i,n;try{i=new RegExp(e,r.filter_case?"g":"gi"),n=n.replace(i,f)}catch(o){}return n}function st(){f.children("li").mouseover(function(){f.children("li").removeClass("auto-focus"),e=n(this),e.addClass("auto-focus")}),f.children("li").mouseout(function(){n(this).removeClass("auto-focus"),e=null})}function wt(){f.unbind("mouseover").unbind("mouseout").mousemove(function(){st(),f.unbind("mousemove")})}function g(){var t=n("#"+p+"_annoninput").children(".maininput");st(),f.children("li").unbind("mousedown").mousedown(function(){var t=n(this);c(t.text(),t.attr("rel"),0,0,1),w(1),h.hide()}),t.unbind("keydown"),t.keydown(function(t){var u,i;if(t.keyCode!=o.backspace&&s.children("li.bit-box.deleted").removeClass("deleted"),(t.keyCode==o.enter||t.keyCode==o.tab||t.keyCode==o.comma)&&ct())return i=e,c(i.text(),i.attr("rel"),0,0,1),nt(t);if((t.keyCode==o.enter||t.keyCode==o.tab||t.keyCode==o.comma)&&!ct()){if(r.newel)return u=y(n(this).val()),c(u,u,0,0,1),nt(t);if((r.addontab||r.addoncomma)&&r.newel)return e=f.children("li:visible:first"),i=e,c(i.text(),i.attr("rel"),0,0,1),nt(t)}t.keyCode==o.downarrow&&ht("first"),t.keyCode==o.uparrow&&ht("last")})}function ht(n){if(wt(),e==null||e.length==0)e=f.children("li:visible:"+n),f.get(0).scrollTop=n=="first"?0:parseInt(e.get(0).scrollHeight,10)*(parseInt(f.children("li:visible").length,10)-Math.round(r.height/2));else{e.removeClass("auto-focus"),e=n=="first"?e.nextAll("li:visible:first"):e.prevAll("li:visible:first");var t=parseInt(e.prevAll("li:visible").length,10),i=parseInt(e.nextAll("li:visible").length,10);((n=="first"?t:i)>Math.round(r.height/2)||(n=="first"?t:i)<=Math.round(r.height/2))&&typeof e.get(0)!="undefined"&&(f.get(0).scrollTop=parseInt(e.get(0).scrollHeight,10)*(t-Math.round(r.height/2)))}f.children("li").removeClass("auto-focus"),e.addClass("auto-focus")}function nt(n){return h.hide(),n.preventDefault(),e=null,!1}function v(){return r.maxitems!=0&&s.children("li.bit-box").length<r.maxitems}function bt(t){if(r.newel&&v()){if(f.children("li[fckb=1]").remove(),t.length==0)return;var i=n('<li rel="'+t+'" fckb="1">').html(l(t));f.prepend(i),b++}return}function tt(n,t){var r={};for(i=0;i<t.get(0).attributes.length;i++)t.get(0).attributes[i].nodeValue!=null&&(r["_"+t.get(0).attributes[i].nodeName]=t.get(0).attributes[i].nodeValue);return n.call(n,r)}function ct(){return e==null||e.length==0?!1:!0}function y(n,t){if(typeof t!="undefined"){for(i=0;i<n.length;i++){var r=n.charCodeAt(i);(o.exclamation<=r&&r<=o.slash||o.colon<=r&&r<=o.at||o.squarebricket_left<=r&&r<=o.apostrof)&&(n=n.replace(n[i],escape(n[i])))}n=n.replace(/(\{|\}|\*)/i,"\\$1")}return n.replace(/script(.*)/g,"")}function l(n,t){return(n=n.toString(),n=n.replace("\\",""),typeof t!="undefined")?n:unescape(n)}function w(n){f.children().remove(),n&&f.hide()}function lt(t){if(b=0,r.json_url&&v())if(r.cache&&et.get(t))d(t),g();else{ft++;var i=ft;setTimeout(function(){i==ft&&n.getJSON(r.json_url,{tag:l(t)},function(n){it&&(d(t,n),et.set(t,1),g())})},r.delay)}else d(t),g()}var r=n.extend({json_url:null,width:512,cache:!1,height:"10",newel:!1,addontab:!1,addoncomma:!1,firstselected:!1,filter_case:!1,filter_selected:!1,filter_begin:!1,complete_text:"Start to type...",select_all_text:null,maxshownitems:30,maxitems:10,oncreate:null,onselect:null,onremove:null,attachto:null,delay:350,input_tabindex:0,input_min_size:1,input_name:"",bricket:!0},t),s=null,f=null,h=null,b=0,it=!1,e=null,rt=0,ut=1,u=n(this),p=u.attr("id"),ft=0,et={set:function(n,t){var i=u.data("jsoncache");i[n]=t,u.data("jsoncache",i)},get:function(n){return u.data("jsoncache")[n]!="undefined"?u.data("jsoncache")[n]:null},init:function(){u.data("jsoncache",{})}},o={enter:13,tab:9,comma:188,backspace:8,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,exclamation:33,slash:47,colon:58,at:64,squarebricket_left:91,apostrof:96},kt=function(){for(var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="",t,n=0;n<32;n++)t=Math.floor(Math.random()*i.length),r+=i.substring(t,t+1);return r},a={search:function(t){var i=[],f=new RegExp((r.filter_begin?"^":"")+t,r.filter_case?"g":"gi");return n.each(u.data("cache"),function(n,t){typeof t.search=="function"&&t.search(f)!=-1&&i.push({key:n,value:t})}),i},set:function(n,t){var i=u.data("cache");i[n]=t,u.data("cache",i)},get:function(n){return u.data("cache")[n]!="undefined"?u.data("cache")[n]:null},clear:function(){u.data("cache",{})},length:function(){if(typeof u.data("cache")=="object"){var n=0;for(i in u.data("cache"))n++;return n}return u.data("cache").length},init:function(){u.data("cache")=="undefined"&&u.data("cache",{})}};return at(),et.init(),a.init(),this})}})(jQuery);
//# sourceMappingURL=jquery.fcbkcomplete.min.js.map