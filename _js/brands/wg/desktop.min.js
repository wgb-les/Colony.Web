var doc=document,win=window,container=$("#container"),content=$("#content"),homeGrid={el:{gridCont:$("#mainContent"),grid:$(".homeGrid"),loader:$(".loader","#content"),overlay:$("#gridOverlay"),arrowL:$(".gridArrow.left"),arrowR:$(".gridArrow.right")},settings:{speed:5},locked:!1,loaded:!1,homepageData:null,overlayTmpl:null,itemTmpl:null,moveRightId:null,moveLeftId:null,gridWidth:0,currentScrollPos:0,totalSections:$("[data-section]").length,currentSection:0,cloneL:null,cloneR:null,loadItemTemplate:function(){var n=this;$.ajax({url:"/_js/brands/wg/templates/homeGridItem.html",cache:!0,type:"GET",success:function(t){n.itemTmpl=_.template(t);n.loadOverlayTemplate()}})},loadOverlayTemplate:function(){var n=this;$.ajax({url:"/_js/brands/wg/templates/homeGridContent.html",type:"GET",cache:!0,success:function(t){n.overlayTmpl=_.template(t);n.getData()}})},getData:function(){var n=this;$.getJSON("/homepages/homepage/data/",function(t){homepageData=t;n.renderItems()})},getHomepageItem:function(n){for(var t=0,r,i,t=0;t<homepageData.length;++t)if(i=homepageData[t],i.Id==n){r=i;break}return r},getScrollPos:function(){return parseInt(this.el.gridCont.scrollLeft())},scrollTracker:function(){var n=this,t=function(){currentScrollPos=n.getScrollPos();currentScrollPos===0&&n.el.gridCont.scrollLeft(n.gridWidth);$(".homeGrid").last().offset().left<0&&n.el.gridCont.scrollLeft(n.gridWidth)},i=function(){win.requestAnimationFrame(t)};n.el.gridCont.on("scroll",i)},renderItems:function(){for(var i,n=this,t=0;t<homepageData.length;t++)if(i=$(".item:eq("+t+")"),i.length>0)i.html(n.itemTmpl({item:homepageData[t]}));else break;n.loaded=!0;n.gridResize();Redant.util.browser.isTablet()||n.scrollTracker()},gridResize:function(){var n=this,t,i,r;if(this.loaded===!0){var n=this,e=$("#mainContent").outerHeight(),u=parseInt(e/2),f=$(".homeGrid");$(".gridRows").each(function(){$(this).width($(this).hasClass("double")?u*2:u)});n.gridWidth=f.first().outerWidth();f.length===1&&(Redant.util.browser.isTablet()||(t=n.el.grid,i=n.el.gridCont,n.cloneL=t.clone().addClass("clone-left"),n.cloneR=t.clone().addClass("clone-right"),n.cloneL.prependTo(i),n.cloneR.appendTo(i)),n.currentSection=_.random(1,n.totalSections),r=$('[data-section="'+n.currentSection+'"]').offset().left,Redant.util.browser.isTablet()?n.el.gridCont.scrollLeft(r):n.el.gridCont.scrollLeft(r+n.gridWidth),n.el.loader.fadeOut(500))}},renderOverlay:function(n){var t=this,f=n.data("itemid"),i=this.getHomepageItem(f),r=$("#gridOverlay"),u=t.el.overlay;n.data("orientation")==="portrait"?u.addClass("portrait"):u.addClass("landscape");i!=null&&(r.html(t.overlayTmpl({item:i})),r.fadeIn(300,function(){$(".gridContent-details",t.el.overlay).slideDown(450);t.el.gridCont.css("overflow","hidden")}));t.locked=!0},closeOverlay:function(){var n=this;n.el.gridCont.removeAttr("style");this.el.overlay.fadeOut(300,function(){n.el.overlay.removeClass("portrait").removeClass("landscape")});n.locked=!1},toggleOverlayDetails:function(n){var r=$(this),i=$(".icon",n),t=$(".hide-label",n);t.html()==="Show"?($(".gridContent-details","#gridOverlay").animate({bottom:0,avoidCSSTransitions:!0},400),i.removeClass("icon-caret-up").addClass("icon-caret-down"),t.html("Hide")):($(".gridContent-details","#gridOverlay").animate({bottom:-($(".gridContent-details","#gridOverlay").outerHeight()-40),avoidCSSTransitions:!0},400),i.removeClass("icon-caret-down").addClass("icon-caret-up"),t.html("Show"))},init:function(){function t(){n.el.gridCont.scrollLeft(n.getScrollPos()+n.settings.speed);moveRightId=win.requestAnimationFrame(t)}function i(){n.el.gridCont.scrollLeft(n.getScrollPos()-n.settings.speed);moveLeftId=win.requestAnimationFrame(i)}var n=this;_.templateSettings.variable="rc";this.loadItemTemplate();$(win).on("resize",_.debounce(function(){n.gridResize()},350));$(document).on("click",".homeGrid .item-trigger",function(t){t.preventDefault();n.renderOverlay($(this))}).on("click","#gridOverlay .hide-toggle",function(t){t.preventDefault();n.toggleOverlayDetails($(this))}).on("click","#gridOverlay .close",function(t){t.preventDefault();n.closeOverlay()});$(".gridArrow").on("click",function(n){n.preventDefault()});this.el.arrowR.on("mouseenter",function(){moveRightId=win.requestAnimationFrame(t)}).on("mouseleave",function(){win.cancelAnimationFrame(moveRightId)});this.el.arrowL.on("mouseenter",function(){moveLeftId=win.requestAnimationFrame(i)}).on("mouseleave",function(){win.cancelAnimationFrame(moveLeftId)});n.el.gridCont.on("mousewheel",function(t,i){n.locked||(this.scrollLeft-=i*30,t.preventDefault())})}};$(document).ready(function(){if(homeGrid.el.grid.length>0){homeGrid.init();$(".brand-toggle").on("click",function(n){n.preventDefault();var t=$(this);$(".brand-toggle").removeClass("active");$(".brand-content").removeClass("active");t.addClass("active");t.next().addClass("active")});$(".close",".brand-content").on("click",function(n){n.preventDefault();$(".brand-toggle").removeClass("active");$(this).parent().removeClass("active")})}});
/*
//# sourceMappingURL=desktop.min.js.map
*/